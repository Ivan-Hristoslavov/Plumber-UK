(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3419],{32987:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var n=s(95155),a=s(12115),i=s(59836),r=s(26597);function o(e){let{content:t,children:s,position:i="top",delay:r=200}=e,[o,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),[x,m]=(0,a.useState)({x:0,y:0}),u=(0,a.useRef)(),h=(0,a.useRef)(null),p=(0,a.useRef)(null);return(0,a.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),(0,n.jsxs)("div",{ref:p,className:"relative inline-block",onMouseEnter:()=>{clearTimeout(u.current),u.current=setTimeout(()=>{if(p.current){let e=p.current.getBoundingClientRect(),t=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop,n=e.left+t+e.width/2,a=e.top+s;switch(i){case"top":a=e.top+s-10;break;case"bottom":a=e.bottom+s+10;break;case"left":n=e.left+t-10,a=e.top+s+e.height/2;break;case"right":n=e.right+t+10,a=e.top+s+e.height/2}m({x:n,y:a})}l(!0),setTimeout(()=>d(!0),10)},r)},onMouseLeave:()=>{clearTimeout(u.current),d(!1),setTimeout(()=>l(!1),150)},children:[s,o&&(0,n.jsx)("div",{ref:h,className:"fixed z-[9999] pointer-events-none ".concat((()=>{switch(i){case"top":default:return"transform -translate-x-1/2 -translate-y-full";case"bottom":return"transform -translate-x-1/2";case"left":return"transform -translate-x-full -translate-y-1/2";case"right":return"transform -translate-y-1/2"}})()," transition-all duration-150 ease-out ").concat(c?"opacity-100 scale-100":"opacity-0 scale-95"),style:{left:"".concat(x.x,"px"),top:"".concat(x.y,"px")},children:(0,n.jsx)("div",{className:"bg-white text-gray-900 text-sm font-medium px-3 py-2 rounded-lg shadow-xl border border-gray-300 whitespace-nowrap backdrop-blur-sm",children:t})})]})}function l(){var e,t,s,l;let[c,d]=(0,a.useState)([]),[x,m]=(0,a.useState)([]),[u,h]=(0,a.useState)([]),[p,g]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null),[v,j]=(0,a.useState)(!1),[f,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)("idle"),[_,C]=(0,a.useState)("idle"),[S,F]=(0,a.useState)(null),[M,D]=(0,a.useState)(null),[T,L]=(0,a.useState)({customer_id:"",booking_id:"",invoice_date:(0,i.GP)(new Date,"yyyy-MM-dd"),due_date:(0,i.GP)(new Date(Date.now()+2592e6),"yyyy-MM-dd"),notes:""}),[P,A]=(0,a.useState)("");(0,a.useEffect)(()=>{z()},[]);let z=async()=>{try{g(!0);let[e,t,s]=await Promise.all([fetch("/api/invoices"),fetch("/api/customers"),fetch("/api/bookings")]);if(e.ok){let t=await e.json();d(t)}if(t.ok){let e=await t.json();m(e)}if(s.ok){let e=await s.json();h(e.bookings||[])}}catch(e){console.error("Error loading data:",e)}finally{g(!1)}},E=async e=>{if(e.preventDefault(),A(""),!T.customer_id||!T.booking_id)return void A("Please select both customer and booking.");try{let e=u.find(e=>e.id===T.booking_id),t=x.find(e=>e.id===T.customer_id);if(!e||!t)return void A("Selected booking or customer not found.");let s=Number((e.amount/1.2).toFixed(2)),n=Number((e.amount-s).toFixed(2)),a={customer_id:T.customer_id,booking_id:T.booking_id,invoice_date:T.invoice_date,due_date:T.due_date,subtotal:s,vat_rate:20,vat_amount:n,total_amount:e.amount,status:"pending",company_name:"FixMyLeak Ltd",company_address:"London, UK",company_phone:"+44 7700 123456",company_email:"admin@fixmyleak.com",company_vat_number:"GB987654321",notes:T.notes||null},r=await fetch("/api/invoices",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(r.ok)await z(),j(!1),L({customer_id:"",booking_id:"",invoice_date:(0,i.GP)(new Date,"yyyy-MM-dd"),due_date:(0,i.GP)(new Date(Date.now()+2592e6),"yyyy-MM-dd"),notes:""});else{let e=await r.json();A(e.error||"Failed to create invoice")}}catch(e){console.error("Error creating invoice:",e),A("Failed to create invoice")}},I=async e=>{F(e.id);try{(function(e){var t,s,n,a;let o=new r.uE({unit:"pt",format:"a4"}),l=o.internal.pageSize.getWidth(),c=40;o.setFillColor(34,197,94),o.rect(0,0,l,60,"F"),o.setFontSize(24),o.setTextColor(255,255,255),o.text("Fix my leak",40,40,{baseline:"middle"}),c=80,o.setFontSize(18),o.setTextColor(34,34,34),o.text("INVOICE",40,c),o.setFontSize(12),o.setTextColor(120,120,120),o.text("Invoice Number: ".concat(e.invoice_number),40,c+20),o.text("Date: ".concat((0,i.GP)(new Date(e.invoice_date),"dd/MM/yyyy")),40,c+36),c+=60,o.setFontSize(11),o.setTextColor(34,34,34),o.text("From:",40,c),o.setFont("helvetica","bold"),o.text(e.company_name,40,c+16),o.setFont("helvetica","normal"),o.text(e.company_address,40,c+32),o.text("VAT: ".concat(e.company_vat_number||"N/A"),40,c+48),o.text("Phone: ".concat(e.company_phone),40,c+64),o.text("Email: ".concat(e.company_email),40,c+80),o.setFont("helvetica","bold"),o.text("Bill To:",320,c),o.setFont("helvetica","normal"),o.text((null==(t=e.customer)?void 0:t.name)||"Unknown Customer",320,c+16),o.text((null==(s=e.customer)?void 0:s.email)||"",320,c+32),o.text((null==(n=e.customer)?void 0:n.address)||"",320,c+48),c+=120,o.setDrawColor(220,220,220),o.line(40,c,l-40,c),c+=20,o.setFont("helvetica","bold"),o.text("Description",40,c),o.text("Amount",l-120,c,{align:"right"}),o.setFont("helvetica","normal"),c+=18,o.setDrawColor(220,220,220),o.line(40,c,l-40,c),c+=20,o.text((null==(a=e.booking)?void 0:a.service)||"Service",40,c),o.text("\xa3".concat(e.total_amount.toFixed(2)),l-120,c,{align:"right"}),c+=30,o.setDrawColor(220,220,220),o.line(40,c,l-40,c),c+=20,o.setFont("helvetica","normal"),o.text("Subtotal",40,c),o.text("\xa3".concat(e.subtotal.toFixed(2)),l-120,c,{align:"right"}),c+=18,o.text("VAT (".concat(e.vat_rate,"%)"),40,c),o.text("\xa3".concat(e.vat_amount.toFixed(2)),l-120,c,{align:"right"}),c+=18,o.setFont("helvetica","bold"),o.text("Total",40,c),o.text("\xa3".concat(e.total_amount.toFixed(2)),l-120,c,{align:"right"}),o.setFontSize(10),o.setTextColor(120,120,120),o.text("Thank you for your business!",40,800),o.save("".concat(e.invoice_number,".pdf"))})(e),await new Promise(e=>setTimeout(e,500))}finally{F(null)}},B=async e=>{D(e.id);try{await new Promise(e=>setTimeout(e,1e3))}finally{D(null)}},G=T.customer_id?u.filter(e=>e.customer_id===T.customer_id&&"completed"===e.status):[],V=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"sent":return"bg-blue-100 text-blue-800";case"paid":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoices"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Manage and generate UK-compliant invoices for your services"})]}),(0,n.jsx)("button",{onClick:()=>j(!0),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Create Invoice"})]}),(0,n.jsx)("div",{className:"bg-white shadow-sm rounded-lg",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice #"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Service"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,n.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,n.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:7,className:"px-4 py-4 text-center text-gray-500",children:"Loading invoices..."})}):0===c.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:7,className:"px-4 py-4 text-center text-gray-500",children:"No invoices found. Create your first invoice using the button above."})}):c.map(e=>{var t,s,a;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.invoice_number}),(0,n.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap",children:[(0,n.jsx)("div",{className:"text-sm text-gray-900",children:(null==(t=e.customer)?void 0:t.name)||"Unknown Customer"}),(0,n.jsx)("div",{className:"text-xs text-gray-500 md:hidden",children:(null==(s=e.booking)?void 0:s.service)||"N/A"})]}),(0,n.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500 hidden md:table-cell",children:(null==(a=e.booking)?void 0:a.service)||"N/A"}),(0,n.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,i.GP)(new Date(e.invoice_date),"dd/MM/yyyy")}),(0,n.jsxs)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["\xa3",e.total_amount.toFixed(2)]}),(0,n.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-4 font-semibold rounded-full ".concat(V(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,n.jsx)("td",{className:"px-4 py-6 whitespace-nowrap text-center",children:(0,n.jsxs)("div",{className:"flex justify-center items-center space-x-1",children:[(0,n.jsx)(o,{content:"View Invoice",position:"top",children:(0,n.jsx)("button",{onClick:()=>{b(e),N(!0)},className:"inline-flex items-center justify-center w-8 h-8 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-colors",children:(0,n.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})}),(0,n.jsx)(o,{content:S===e.id?"Generating PDF...":"Download PDF",position:"top",children:(0,n.jsx)("button",{onClick:()=>I(e),className:"inline-flex items-center justify-center w-8 h-8 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-full transition-colors",disabled:S===e.id,children:S===e.id?(0,n.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})}),(0,n.jsx)(o,{content:M===e.id?"Sending Email...":"Send Invoice by Email",position:"top",children:(0,n.jsx)("button",{onClick:()=>B(e),className:"inline-flex items-center justify-center w-8 h-8 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-full transition-colors",disabled:M===e.id,children:M===e.id?(0,n.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})}),(0,n.jsx)("div",{className:"relative md:hidden",children:(0,n.jsx)(o,{content:"More Options",position:"top",children:(0,n.jsx)("button",{className:"inline-flex items-center justify-center w-8 h-8 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",onClick:e=>{e.stopPropagation()},children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})})]})})]},e.id)})})]})})}),f&&y&&(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,n.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Invoice ",y.invoice_number]}),(0,n.jsx)(o,{content:"Close",position:"left",children:(0,n.jsxs)("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-500",children:[(0,n.jsx)("span",{className:"sr-only",children:"Close"}),(0,n.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"border-b pb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900",children:"Company Details"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:y.company_name}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:y.company_address}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Email: ",y.company_email]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["Phone: ",y.company_phone]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:["VAT: ",y.company_vat_number||"N/A"]})]}),(0,n.jsxs)("div",{className:"border-b pb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900",children:"Customer Details"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:(null==(e=y.customer)?void 0:e.name)||"Unknown Customer"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:(null==(t=y.customer)?void 0:t.email)||"N/A"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:(null==(s=y.customer)?void 0:s.address)||"N/A"})]}),(0,n.jsxs)("div",{className:"border-b pb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900",children:"Invoice Details"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Service"}),(0,n.jsx)("p",{className:"font-medium",children:(null==(l=y.booking)?void 0:l.service)||"N/A"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Date"}),(0,n.jsx)("p",{className:"font-medium",children:(0,i.GP)(new Date(y.invoice_date),"dd/MM/yyyy")})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Due Date"}),(0,n.jsx)("p",{className:"font-medium",children:y.due_date?(0,i.GP)(new Date(y.due_date),"dd/MM/yyyy"):"N/A"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-gray-600",children:"Status"}),(0,n.jsx)("p",{className:"font-medium capitalize",children:y.status})]})]})]}),(0,n.jsxs)("div",{className:"border-b pb-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900",children:"VAT Calculation"}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between py-1",children:[(0,n.jsx)("span",{children:"Subtotal"}),(0,n.jsxs)("span",{children:["\xa3",y.subtotal.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"flex justify-between py-1",children:[(0,n.jsxs)("span",{children:["VAT (",y.vat_rate,"%)"]}),(0,n.jsxs)("span",{children:["\xa3",y.vat_amount.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"flex justify-between py-1 font-semibold",children:[(0,n.jsx)("span",{children:"Total"}),(0,n.jsxs)("span",{children:["\xa3",y.total_amount.toFixed(2)]})]})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)(o,{content:S===y.id?"Generating PDF...":"Download PDF",position:"top",children:(0,n.jsxs)("button",{onClick:()=>I(y),className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",disabled:S===y.id,children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),S===y.id?"Generating...":"Download PDF"]})}),(0,n.jsx)(o,{content:M===y.id?"Sending Email...":"Send Invoice by Email",position:"top",children:(0,n.jsxs)("button",{onClick:()=>B(y),className:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",disabled:M===y.id,children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),M===y.id?"Sending...":"Send Email"]})})]})]})]})}),v&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] relative",children:[(0,n.jsx)("button",{type:"button",onClick:()=>j(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"Close",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,n.jsxs)("form",{className:"p-8 space-y-6 overflow-y-auto max-h-[70vh]",onSubmit:E,children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4 text-blue-600",children:"Create New Invoice"}),P&&(0,n.jsx)("div",{className:"text-red-600 text-sm mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:P}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Customer",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsxs)("select",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:T.customer_id,onChange:e=>L(t=>({...t,customer_id:e.target.value,booking_id:""})),required:!0,children:[(0,n.jsx)("option",{value:"",children:"Select a customer"}),x.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Booking",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsxs)("select",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:T.booking_id,onChange:e=>L(t=>({...t,booking_id:e.target.value})),required:!0,disabled:!T.customer_id,children:[(0,n.jsx)("option",{value:"",children:"Select a booking"}),G.map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.service," - ",(0,i.GP)(new Date(e.date),"dd/MM/yyyy")," - \xa3",e.amount]},e.id))]}),T.customer_id&&0===G.length&&(0,n.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"No completed bookings found for this customer."})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Invoice Date",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{type:"date",className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:T.invoice_date,onChange:e=>L(t=>({...t,invoice_date:e.target.value})),required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Due Date",(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{type:"date",className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",value:T.due_date,onChange:e=>L(t=>({...t,due_date:e.target.value})),required:!0})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (Optional)"}),(0,n.jsx)("textarea",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",rows:3,value:T.notes,onChange:e=>L(t=>({...t,notes:e.target.value})),placeholder:"Additional notes for this invoice..."})]}),T.booking_id&&(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Invoice Preview"}),(()=>{let e=u.find(e=>e.id===T.booking_id);if(!e)return null;let t=Number((e.amount/1.2).toFixed(2)),s=Number((e.amount-t).toFixed(2));return(0,n.jsxs)("div",{className:"text-sm space-y-1",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Subtotal:"}),(0,n.jsxs)("span",{children:["\xa3",t.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"VAT (20%):"}),(0,n.jsxs)("span",{children:["\xa3",s.toFixed(2)]})]}),(0,n.jsxs)("div",{className:"flex justify-between font-semibold border-t pt-1",children:[(0,n.jsx)("span",{children:"Total:"}),(0,n.jsxs)("span",{children:["\xa3",e.amount.toFixed(2)]})]})]})})()]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Create Invoice"})]})]})]})})]})}},67782:(e,t,s)=>{Promise.resolve().then(s.bind(s,32987))}},e=>{var t=t=>e(e.s=t);e.O(0,[3930,9836,913,8441,1684,7358],()=>t(67782)),_N_E=e.O()}]);