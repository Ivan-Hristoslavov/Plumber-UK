(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[641],{27672:(e,t,s)=>{Promise.resolve().then(s.bind(s,82601))},82601:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(95155),a=s(12115),l=s(59836),n=s(84423),i=s(98794),d=s(7239),c=s(89447);function o(e,t,s){let r=(0,c.a)(e,null==s?void 0:s.in);return isNaN(t)?(0,d.w)((null==s?void 0:s.in)||e,NaN):(t&&r.setDate(r.getDate()+t),r)}var x=s(61183),m=s(6711);function u(e,t,s){let[r,a]=(0,x.x)(null==s?void 0:s.in,e,t);return+(0,m.o)(r)==+(0,m.o)(a)}function h(){let[e,t]=(0,a.useState)((0,l.GP)(new Date,"yyyy-MM-dd")),[s,d]=(0,a.useState)(null),[c,x]=(0,a.useState)("week"),[m,h]=(0,a.useState)(null),[g,p]=(0,a.useState)([]),[b,j]=(0,a.useState)(!0),[y,N]=(0,a.useState)(null),[v,f]=(0,a.useState)("all"),w=(0,n.k)((0,i.H)(e),{weekStartsOn:1}),k=Array.from({length:7},(e,t)=>o(w,t));(0,a.useEffect)(()=>{C();let e=setInterval(C,3e4);return()=>clearInterval(e)},[]);let C=async()=>{try{j(!0),N(null);let e=await fetch("/api/bookings");if(!e.ok)throw Error("Failed to fetch bookings");let t=await e.json();p(t.bookings||[])}catch(e){console.error("Error loading bookings:",e),N("Failed to load bookings")}finally{j(!1)}},M=e=>{let t=g.filter(t=>u((0,i.H)(t.date),e));return"all"!==v&&(t=t.filter(e=>e.status===v)),t},D=e=>{switch(e){case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"refunded":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},T=async(e,t)=>{try{if((await fetch("/api/bookings/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)await C(),d(null);else throw Error("Failed to update booking status")}catch(e){console.error("Error updating booking status:",e),N("Failed to update booking status")}};return b?(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading calendar..."})]})}):y?(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error loading calendar"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-red-700",children:y}),(0,r.jsx)("button",{onClick:C,className:"mt-2 text-sm text-red-800 hover:text-red-900 underline",children:"Try again"})]})]})})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Calendar"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>x("week"),className:"px-4 py-2 rounded-lg text-sm font-medium ".concat("week"===c?"bg-primary text-white":"bg-white text-gray-600"),children:"Week"}),(0,r.jsx)("button",{onClick:()=>x("day"),className:"px-4 py-2 rounded-lg text-sm font-medium ".concat("day"===c?"bg-primary text-white":"bg-white text-gray-600"),children:"Day"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("select",{value:v,onChange:e=>f(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsxs)("option",{value:"all",children:["All Bookings (",g.length,")"]}),(0,r.jsxs)("option",{value:"pending",children:["Pending (",g.filter(e=>"pending"===e.status).length,")"]}),(0,r.jsxs)("option",{value:"scheduled",children:["Scheduled (",g.filter(e=>"scheduled"===e.status).length,")"]}),(0,r.jsxs)("option",{value:"completed",children:["Completed (",g.filter(e=>"completed"===e.status).length,")"]}),(0,r.jsxs)("option",{value:"cancelled",children:["Cancelled (",g.filter(e=>"cancelled"===e.status).length,")"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-yellow-100 rounded border border-yellow-200"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Pending"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-blue-100 rounded border border-blue-200"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Scheduled"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-green-100 rounded border border-green-200"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Completed"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-3 h-3 bg-red-100 rounded border border-red-200"}),(0,r.jsx)("span",{className:"text-gray-600",children:"Cancelled"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>t((0,l.GP)(o((0,i.H)(e),-7),"yyyy-MM-dd")),className:"p-2 rounded-lg hover:bg-gray-100",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,r.jsxs)("span",{className:"text-lg font-medium",children:[(0,l.GP)(w,"MMM d")," - ",(0,l.GP)(o(w,6),"MMM d, yyyy")]}),(0,r.jsx)("button",{onClick:()=>t((0,l.GP)(o((0,i.H)(e),7),"yyyy-MM-dd")),className:"p-2 rounded-lg hover:bg-gray-100",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,r.jsx)("button",{onClick:()=>t((0,l.GP)(new Date,"yyyy-MM-dd")),className:"px-3 py-2 text-sm font-medium text-primary border border-primary rounded-lg hover:bg-primary hover:text-white transition-colors",children:"Today"}),(0,r.jsx)("button",{onClick:C,disabled:b,className:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50",title:"Refresh calendar",children:(0,r.jsx)("svg",{className:"w-5 h-5 ".concat(b?"animate-spin":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsxs)("div",{className:"grid grid-cols-8 border-b",children:[(0,r.jsx)("div",{className:"p-4 border-r"}),k.map(e=>(0,r.jsxs)("div",{className:"p-4 text-center border-r ".concat(u(e,new Date)?"bg-primary/5":""),children:[(0,r.jsx)("div",{className:"font-medium",children:(0,l.GP)(e,"EEE")}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:(0,l.GP)(e,"MMM d")})]},e.toString()))]}),Array.from({length:11},(e,t)=>t+8).map(e=>(0,r.jsxs)("div",{className:"grid grid-cols-8 border-b last:border-b-0",children:[(0,r.jsx)("div",{className:"p-4 border-r text-sm text-gray-500",children:(0,l.GP)(new Date().setHours(e,0),"HH:00")}),k.map(t=>{let s=M(t).filter(t=>parseInt(t.time.split(":")[0])===e);return(0,r.jsx)("div",{className:"p-2 border-r min-h-[100px] relative",children:s.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>d(s[0]),className:"w-full p-2 mb-2 text-left rounded-lg transition-colors ".concat("completed"===s[0].status?"bg-green-50 hover:bg-green-100 border border-green-200":"cancelled"===s[0].status?"bg-red-50 hover:bg-red-100 border border-red-200":"pending"===s[0].status?"bg-yellow-50 hover:bg-yellow-100 border border-yellow-200":"bg-blue-50 hover:bg-blue-100 border border-blue-200"),children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:s[0].customer_name}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:s[0].service}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:s[0].time}),(0,r.jsxs)("div",{className:"flex space-x-1 mt-1",children:[(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs ".concat(D(s[0].status)),children:s[0].status}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs ".concat(S(s[0].payment_status)),children:s[0].payment_status})]})]},s[0].id),s.length>1&&(0,r.jsxs)("button",{onClick:()=>h(s),className:"w-full p-1 text-xs text-center rounded bg-gray-100 hover:bg-gray-200 border border-gray-200",children:["+",s.length-1," more"]})]})},t.toString())})]},e))]}),s&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Booking Details"}),(0,r.jsx)("button",{onClick:()=>d(null),className:"text-gray-400 hover:text-gray-500",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Customer"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900",children:s.customer_name}),s.customer_email&&(0,r.jsx)("div",{className:"text-sm text-gray-600",children:s.customer_email}),s.customer_phone&&(0,r.jsx)("div",{className:"text-sm text-gray-600",children:s.customer_phone})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Service"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900",children:s.service})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900",children:(0,l.GP)((0,i.H)(s.date),"MMM dd, yyyy")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Time"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900",children:s.time})]})]}),s.address&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900",children:s.address})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsxs)("select",{value:s.status,onChange:e=>T(s.id,e.target.value),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,r.jsx)("option",{value:"completed",children:"Completed"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Payment"}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("span",{className:"px-2 py-1 rounded text-sm ".concat(S(s.payment_status)),children:s.payment_status})})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Amount"}),(0,r.jsxs)("div",{className:"mt-1 text-gray-900",children:["\xa3",s.amount.toFixed(2)]})]}),s.notes&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,r.jsx)("div",{className:"mt-1 text-gray-900 bg-gray-50 p-2 rounded text-sm",children:s.notes})]})]}),(0,r.jsx)("div",{className:"mt-6 flex justify-end space-x-3",children:(0,r.jsx)("button",{onClick:()=>d(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})})}),m&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Bookings for this slot"}),(0,r.jsx)("button",{onClick:()=>h(null),className:"text-gray-400 hover:text-gray-500",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("div",{className:"space-y-4",children:m.map(e=>(0,r.jsx)("div",{className:"border rounded p-3 mb-2 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.customer_name}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:e.service}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:e.time}),(0,r.jsxs)("div",{className:"flex space-x-1 mt-1",children:[(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs ".concat(D(e.status)),children:e.status}),(0,r.jsx)("span",{className:"px-1.5 py-0.5 rounded text-xs ".concat(S(e.payment_status)),children:e.payment_status})]})]}),(0,r.jsx)("button",{onClick:()=>{d(e),h(null)},className:"ml-2 px-2 py-1 text-xs bg-primary text-white rounded hover:bg-primary-dark",children:"View"})]})},e.id))}),(0,r.jsx)("div",{className:"mt-6 flex justify-end",children:(0,r.jsx)("button",{onClick:()=>h(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})})})]})}},98794:(e,t,s)=>{"use strict";s.d(t,{H:()=>n});var r=s(25703),a=s(7239),l=s(89447);function n(e,t){var s;let n,g,p=()=>(0,a.w)(null==t?void 0:t.in,NaN),b=null!=(s=null==t?void 0:t.additionalDigits)?s:2,j=function(e){let t,s={},r=e.split(i.dateTimeDelimiter);if(r.length>2)return s;if(/:/.test(r[0])?t=r[0]:(s.date=r[0],t=r[1],i.timeZoneDelimiter.test(s.date)&&(s.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(s.date.length,e.length))),t){let e=i.timezone.exec(t);e?(s.time=t.replace(e[1],""),s.timezone=e[1]):s.time=t}return s}(e);if(j.date){let e=function(e,t){let s=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(s);if(!r)return{year:NaN,restDateString:""};let a=r[1]?parseInt(r[1]):null,l=r[2]?parseInt(r[2]):null;return{year:null===l?a:100*l,restDateString:e.slice((r[1]||r[2]).length)}}(j.date,b);n=function(e,t){var s,r,a,l,n,i,c,o;if(null===t)return new Date(NaN);let m=e.match(d);if(!m)return new Date(NaN);let g=!!m[4],p=x(m[1]),b=x(m[2])-1,j=x(m[3]),y=x(m[4]),N=x(m[5])-1;if(g){return(s=0,r=y,a=N,r>=1&&r<=53&&a>=0&&a<=6)?function(e,t,s){let r=new Date(0);r.setUTCFullYear(e,0,4);let a=r.getUTCDay()||7;return r.setUTCDate(r.getUTCDate()+((t-1)*7+s+1-a)),r}(t,y,N):new Date(NaN)}{let e=new Date(0);return(l=t,n=b,i=j,n>=0&&n<=11&&i>=1&&i<=(u[n]||(h(l)?29:28))&&(c=t,(o=p)>=1&&o<=(h(c)?366:365)))?(e.setUTCFullYear(t,b,Math.max(p,j)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!n||isNaN(+n))return p();let y=+n,N=0;if(j.time&&isNaN(N=function(e){var t,s,a;let l=e.match(c);if(!l)return NaN;let n=m(l[1]),i=m(l[2]),d=m(l[3]);return(t=n,s=i,a=d,24===t?0===s&&0===a:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25)?n*r.s0+i*r.Cg+1e3*d:NaN}(j.time)))return p();if(j.timezone){if(isNaN(g=function(e){var t,s;if("Z"===e)return 0;let a=e.match(o);if(!a)return 0;let l="+"===a[1]?-1:1,n=parseInt(a[2]),i=a[3]&&parseInt(a[3])||0;return(t=0,(s=i)>=0&&s<=59)?l*(n*r.s0+i*r.Cg):NaN}(j.timezone)))return p()}else{let e=new Date(y+N),s=(0,l.a)(0,null==t?void 0:t.in);return s.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),s.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),s}return(0,l.a)(y+N+g,null==t?void 0:t.in)}let i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},d=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,c=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,o=/^([+-])(\d{2})(?::?(\d{2}))?$/;function x(e){return e?parseInt(e):1}function m(e){return e&&parseFloat(e.replace(",","."))||0}let u=[31,null,31,30,31,30,31,31,30,31,30,31];function h(e){return e%400==0||e%4==0&&e%100!=0}}},e=>{var t=t=>e(e.s=t);e.O(0,[9836,8441,1684,7358],()=>t(27672)),_N_E=e.O()}]);