(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1016],{16249:(e,s,a)=>{Promise.resolve().then(a.bind(a,73995))},73995:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var t=a(95155),r=a(12115);function n(){let[e,s]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)("individual"),[o,c]=(0,r.useState)({name:"",email:"",phone:"",address:"",companyName:"",companyEmail:"",companyPhone:"",companyAddress:"",vat:"",contactPerson:"",contactEmail:"",contactPhone:""}),[d,m]=(0,r.useState)(""),[x,u]=(0,r.useState)([]),[p,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{g()},[]);let g=async()=>{try{h(!0),console.log("Loading customers...");let e=await fetch("/api/customers");if(console.log("Response status:",e.status),e.ok){let s=await e.json();console.log("Loaded customers:",s),u(s)}else{let s=await e.text();console.error("Failed to load customers:",e.status,s)}}catch(e){console.error("Error loading customers:",e)}finally{h(!1)}},y=async e=>{e.preventDefault(),m("");try{let e;if("individual"===l){if(!o.name||!o.email||!o.phone||!o.address)return void m("Please fill in all required fields.");e={name:o.name,email:o.email,phone:o.phone,address:o.address,customer_type:"individual"}}else{if(!o.companyName||!o.companyEmail||!o.companyPhone||!o.companyAddress)return void m("Please fill in all required fields.");e={name:o.companyName,email:o.companyEmail,phone:o.companyPhone,address:o.companyAddress,customer_type:"company",company_name:o.companyName,vat_number:o.vat||null,contact_person:o.contactPerson||null,contact_email:o.contactEmail||null,contact_phone:o.contactPhone||null}}let s=await fetch("/api/customers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok)await g(),n(!1),i("individual"),c({name:"",email:"",phone:"",address:"",companyName:"",companyEmail:"",companyPhone:"",companyAddress:"",vat:"",contactPerson:"",contactEmail:"",contactPhone:""});else{let e=await s.json();m(e.error||"Failed to create customer")}}catch(e){console.error("Error creating customer:",e),m("Failed to create customer")}};return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Customers"}),(0,t.jsx)("button",{onClick:()=>n(!0),className:"px-4 py-2 text-sm font-medium text-white bg-primary rounded-lg hover:bg-primary-dark",children:"Add Customer"})]}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:p?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"Loading customers..."})}):0===x.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"No customers found. Add your first customer using the button above."})}):x.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.name,"company"===e.customer_type&&e.contact_person&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Contact: ",e.contact_person]})]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,t.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("individual"===e.customer_type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:"individual"===e.customer_type?"Individual":"Company"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.phone}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.address}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,t.jsx)("button",{onClick:()=>s(e),className:"px-3 py-1.5 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"View"})})]},e.id))})]})}),a&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] relative",children:[(0,t.jsx)("button",{type:"button",onClick:()=>n(!1),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"Close",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsxs)("form",{className:"p-8 space-y-6 overflow-y-auto max-h-[70vh]",onSubmit:y,children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4 text-primary",children:"Add Customer"}),(0,t.jsxs)("div",{className:"flex space-x-2 mb-6",children:[(0,t.jsx)("button",{type:"button",className:"flex-1 px-4 py-2 rounded-lg font-medium border transition-colors duration-150 ".concat("individual"===l?"bg-primary text-white border-primary shadow":"bg-gray-50 text-gray-700 border-gray-300 hover:bg-gray-100"),onClick:()=>i("individual"),children:"Individual"}),(0,t.jsx)("button",{type:"button",className:"flex-1 px-4 py-2 rounded-lg font-medium border transition-colors duration-150 ".concat("company"===l?"bg-primary text-white border-primary shadow":"bg-gray-50 text-gray-700 border-gray-300 hover:bg-gray-100"),onClick:()=>i("company"),children:"Company"})]}),d&&(0,t.jsx)("div",{className:"text-red-600 text-sm mb-2",children:d}),"individual"===l?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.name,onChange:e=>c(s=>({...s,name:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"email",className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.email,onChange:e=>c(s=>({...s,email:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.phone,onChange:e=>c(s=>({...s,phone:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Address",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.address,onChange:e=>c(s=>({...s,address:e.target.value})),required:!0})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Company Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Name",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.companyName,onChange:e=>c(s=>({...s,companyName:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Email",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"email",className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.companyEmail,onChange:e=>c(s=>({...s,companyEmail:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Phone",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.companyPhone,onChange:e=>c(s=>({...s,companyPhone:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Address",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.companyAddress,onChange:e=>c(s=>({...s,companyAddress:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"VAT Number"}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.vat,onChange:e=>c(s=>({...s,vat:e.target.value}))})]})]}),(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Contact Person (optional)"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.contactPerson,onChange:e=>c(s=>({...s,contactPerson:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email"}),(0,t.jsx)("input",{type:"email",className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.contactEmail,onChange:e=>c(s=>({...s,contactEmail:e.target.value}))})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),(0,t.jsx)("input",{className:"block w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-primary focus:border-primary transition",value:o.contactPhone,onChange:e=>c(s=>({...s,contactPhone:e.target.value}))})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 flex justify-end space-x-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-primary rounded-lg hover:bg-primary-dark shadow",children:"Add Customer"})]})]})]})}),e&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Customer Details"}),(0,t.jsx)("button",{onClick:()=>s(null),className:"text-gray-400 hover:text-gray-500",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Name:"})," ",e.name]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Email:"})," ",e.email]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Phone:"})," ",e.phone]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Address:"})," ",e.address]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Bookings"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.bookings&&e.bookings.length>0?e.bookings.map(e=>(0,t.jsxs)("li",{className:"text-sm text-gray-700",children:[e.date,": ",e.service," (\xa3",e.amount,") - ",(0,t.jsx)("span",{className:"capitalize",children:e.status})," / ",(0,t.jsx)("span",{className:"capitalize",children:e.paymentStatus})]},e.id)):(0,t.jsx)("li",{className:"text-sm text-gray-500",children:"No bookings found"})})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Payments"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.payments&&e.payments.length>0?e.payments.map(e=>(0,t.jsxs)("li",{className:"text-sm text-gray-700",children:[e.date,": \xa3",e.amount," - ",(0,t.jsx)("span",{className:"capitalize",children:e.status})]},e.id)):(0,t.jsx)("li",{className:"text-sm text-gray-500",children:"No payments found"})})]}),(0,t.jsx)("div",{className:"mt-6 flex justify-end",children:(0,t.jsx)("button",{onClick:()=>s(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8441,1684,7358],()=>s(16249)),_N_E=e.O()}]);